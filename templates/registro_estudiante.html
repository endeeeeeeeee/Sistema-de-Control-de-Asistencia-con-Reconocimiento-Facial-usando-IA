<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Estudiantes - CLASS VISION</title>
    <link rel="stylesheet" href="/static/css/registro_estudiante.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Registro de Estudiantes</h1>
            <p>Completa tu registro en 3 simples pasos</p>
        </div>

        <div class="card">
            <div id="alert" class="alert"></div>

            <!-- Indicador de pasos -->
            <div class="steps">
                <div class="step active" id="stepIndicator1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Datos Personales</div>
                </div>
                <div class="step" id="stepIndicator2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Foto Facial</div>
                </div>
                <div class="step" id="stepIndicator3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Confirmaci√≥n</div>
                </div>
            </div>

            <!-- Paso 1: Datos Personales -->
            <div class="form-section active" id="step1">
                <h3 style="margin-bottom: 20px; color: var(--primary);">üìù Informaci√≥n Personal</h3>
                
                <div class="form-group">
                    <label for="nombreCompleto">Nombre Completo *</label>
                    <input type="text" id="nombreCompleto" class="form-control" required placeholder="Juan P√©rez Garc√≠a">
                </div>

                <div class="form-group">
                    <label for="cedula">C√©dula de Identidad *</label>
                    <input type="text" id="cedula" class="form-control" required placeholder="12345678">
                </div>

                <div class="form-group">
                    <label for="telefono">Tel√©fono *</label>
                    <input type="tel" id="telefono" class="form-control" required placeholder="71234567">
                </div>

                <div class="form-group">
                    <label for="email">Correo Electr√≥nico</label>
                    <input type="email" id="email" class="form-control" placeholder="correo@ejemplo.com">
                    <div class="help-text">Recibir√°s notificaciones en este correo</div>
                </div>

                <div class="form-group">
                    <label for="fechaNacimiento">Fecha de Nacimiento *</label>
                    <input type="date" id="fechaNacimiento" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="genero">G√©nero *</label>
                    <select id="genero" class="form-control" required>
                        <option value="">Seleccionar</option>
                        <option value="M">Masculino</option>
                        <option value="F">Femenino</option>
                        <option value="Otro">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="password">Contrase√±a *</label>
                    <input type="password" id="password" class="form-control" required placeholder="M√≠nimo 6 caracteres" minlength="6">
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirmar Contrase√±a *</label>
                    <input type="password" id="confirmPassword" class="form-control" required placeholder="Repite tu contrase√±a" minlength="6">
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-primary" onclick="nextStep(1)">
                        Siguiente: Foto Facial ‚Üí
                    </button>
                </div>
            </div>

            <!-- Paso 2: Foto Facial -->
            <div class="form-section" id="step2">
                <h3 style="margin-bottom: 20px; color: var(--primary);">üì∏ Captura Autom√°tica de Fotos</h3>
                <p style="margin-bottom: 20px; color: #666;">
                    El sistema capturar√° <strong>50 fotos autom√°ticamente</strong> para entrenar el reconocimiento facial con alta precisi√≥n
                </p>

                <div class="alert alert-info" id="captureInstructions" style="display: block; background: #DBEAFE; color: #1E40AF; border-left: 4px solid #3B82F6;">
                    <strong>Instrucciones:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>Mant√©n tu rostro dentro del cuadro</li>
                        <li>Mueve ligeramente la cabeza (izquierda, derecha, arriba, abajo)</li>
                        <li>El proceso tomar√° aproximadamente 10 segundos</li>
                        <li>Mant√©n buena iluminaci√≥n</li>
                    </ul>
                </div>

                <div id="captureProgress" style="text-align: center; margin-bottom: 20px; display: none;">
                    <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                        Capturando: <span id="photoCount">0</span> / 50 fotos
                    </div>
                    <div style="width: 100%; max-width: 400px; margin: 15px auto; background: #E5E7EB; height: 20px; border-radius: 10px; overflow: hidden;">
                        <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--secondary), var(--accent)); transition: width 0.2s;"></div>
                    </div>
                </div>

                <div class="camera-container">
                    <img id="photoPreview" class="photo-preview" alt="Vista previa">
                    <video id="video" autoplay></video>
                    <canvas id="canvas"></canvas>
                    
                    <div class="btn-group" style="max-width: 400px; margin: 20px auto;">
                        <button type="button" class="btn btn-primary" id="btnStartCamera" onclick="startCapture()">
                            üì∑ Iniciar Captura Autom√°tica
                        </button>
                        <button type="button" class="btn btn-secondary" id="btnRetake" onclick="retakeAllPhotos()" style="display: none;">
                            üîÑ Reiniciar Capturas
                        </button>
                    </div>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="prevStep(2)">
                        ‚Üê Atr√°s
                    </button>
                    <button type="button" class="btn btn-primary" id="btnNextStep2" onclick="nextStep(2)" disabled>
                        Siguiente: Confirmar ‚Üí
                    </button>
                </div>
            </div>

            <!-- Paso 3: Confirmaci√≥n -->
            <div class="form-section" id="step3">
                <h3 style="margin-bottom: 20px; color: var(--primary);">‚úÖ Confirmar Registro</h3>
                
                <div class="summary-grid">
                    <div class="summary-item">
                        <strong>Nombre Completo</strong>
                        <span id="summaryName"></span>
                    </div>
                    <div class="summary-item">
                        <strong>C√©dula</strong>
                        <span id="summaryCedula"></span>
                    </div>
                    <div class="summary-item">
                        <strong>Email</strong>
                        <span id="summaryEmail"></span>
                    </div>
                    <div class="summary-item">
                        <strong>Tel√©fono</strong>
                        <span id="summaryPhone"></span>
                    </div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <img id="summaryPhoto" class="photo-preview" style="display: inline-block;" alt="Foto">
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="prevStep(3)">
                        ‚Üê Atr√°s
                    </button>
                    <button type="button" class="btn btn-primary" id="btnRegister" onclick="registerStudent()">
                        ‚úÖ Confirmar Registro
                    </button>
                </div>
            </div>

            <!-- Paso 4: √âxito (oculto inicialmente) -->
            <div class="form-section" id="step4">
                <div class="success-icon">üéâ</div>
                <h2 style="text-align: center; color: var(--success); margin-bottom: 20px;">
                    ¬°Registro Exitoso!
                </h2>
                <p style="text-align: center; color: #666; font-size: 16px; margin-bottom: 30px;">
                    Tu cuenta ha sido creada correctamente. Los docentes ahora podr√°n agregarte a sus materias usando tu c√≥digo de estudiante.
                </p>
                <div style="text-align: center;">
                    <button type="button" class="btn btn-primary" onclick="window.location.href='/login'">
                        Ir a Inicio de Sesi√≥n
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/registro_estudiante.js"></script>
</body>
</html>
